# MPII Human Pose Dataset
[MPII Human Pose dataset](http://human-pose.mpi-inf.mpg.de) is a state of the art benchmark for evaluation of articulated human pose estimation. The dataset
includes around 25K images containing over 40K people with annotated body joints. The images were systematically 
collected using an established taxonomy of every day human activities. Overall the dataset covers 410 human activities 
and each image is provided with an activity label. Each image was extracted from a YouTube video and provided with 
preceding and following un-annotated frames.

## Export to EROS-Like Format
Although it provides RGB images, MPII can be converted to a representation similar to the one generated by the EROS
algorithm. The resulting images can then be used for training an EROS based human pose estimation algorithm.

1. Download the MPII images and annotations from this [url](http://human-pose.mpi-inf.mpg.de/#download)
2. Unzip the data
3. Run the script
   ```shell
   $ python export_to_eros.py -a <path_to_annotation_file> -i <path_to_images_folder> -o <path_to_output_folder>
   ```
The script will generate EROS-like images and saves them in the specified output folder.

The EROS-like representation is based on a combination of Canny edge detection, Gaussian blur and salt and pepper noise.
Below is a list of other parameters that can be modified

```
# canny edge detector params
-gk: gaussian blur kernel size, default=5
-gs: gaussian blur sigma, default=0
-cl: canny edge low threshold, default=0
-ch: canny edge high threshold, default=1000
-ca: canny edge aperture, default=5
-cg: canny edge l2 gradient flag, default False

# salt and pepper params
-sl: salt and pepper low threshold, default=5
-sh: salt and pepper high threshold, default=250
```

## Export to Movenet's Format
Once the EROS-like frames have been created, MPII annotations can be converted to a format compatible with the training
code of Movenet's algorithm

1. Run the script
   ```shell
   $ python export_to_movenet.py -a <path_to_annotation_file> -i <path_to_eros-like_images_folder> -o <path_to_output_folder> -crop
   ```

The script will generate a `poses.json` file in the output folder, containing the annotated poses in the correct format
(see example below)

```
[
    {"img_name": "0.jpg",
    "keypoints": [x0,y0,z0,x1,y1,z1,...],  # flattened array of x, y coordinates and value z: 0 for no label, 1 for labeled but invisible, 2 for labeled and visible
    "center": [x,y],  # pose center
    "bbox":[x0,y0,x1,y1],  # pose bounding box
    "other_centers": [[x0,y0],[x1,y1],...],  # list of other poses' centers
    "other_keypoints": [[[x0,y0],[x1,y1],...],[[x0,y0],[x1,y1],...],...],  # list of other poses' keypoints; other_keypoints[i] = list of keypoints for joint 'i'
    },
    ...
]
```

Additionally, images will be cropped using the bounding boxes around single poses and saved to the output folder as 
`<image_name>_<pose_num>.<ext>`; keypoints coordinates will also be transformed to the bounding box reference system.
This post-processing step can be eliminated by removing parameter `-crop`.

## Export to YARP Format
Export of MPII to YARP format has not been implemented yet.
